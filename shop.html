<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shop | WildTails & Paws Walkers</title>
  <link rel="shortcut icon" href="WildTails-PawsWalkers/front logo.png" type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&family=Playfair+Display&display=swap" rel="stylesheet" />
  <style>
    body {
      margin:0;
      font-family:'Quicksand',sans-serif;
      background-image:url("https://i.postimg.cc/hjpvXjfH/Untitled-design-1.png");
      background-size:cover;
      background-attachment:fixed;
      background-repeat:no-repeat;
      color:#222;
      scroll-behavior:smooth;
    }

    #logo {
      position:fixed;
      top:10px;
      left:10px;
      height:280px;
      width:auto;
      z-index:999;
      border-radius:50%;
    }

    nav {
      position:fixed;
      top:0;
      width:100%;
      background-color:#5C4033;
      z-index:998;
      padding-left:130px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    nav ul {
      list-style:none;
      margin:0;
      padding:0;
      display:flex;
      justify-content:flex-end;
      flex-wrap:wrap;
      transition:max-height 0.3s ease-in-out;
    }

    nav li { margin:0; }
    nav a {
      display:block;
      padding:18px 20px;
      text-decoration:none;
      color:white;
      font-weight:bold;
      transition:background 0.3s ease;
    }

    nav a:hover { background-color:#4e2f22; }

    .menu-toggle {
      display:none;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      cursor:pointer;
      padding:10px 20px;
    }

    .menu-toggle div {
      width:25px;
      height:3px;
      background:white;
      margin:4px 0;
      transition:all 0.3s ease;
    }

    .menu-toggle.active div:nth-child(1) {
      transform:rotate(45deg) translate(5px,5px);
    }
    .menu-toggle.active div:nth-child(2) {
      opacity:0;
    }
    .menu-toggle.active div:nth-child(3) {
      transform:rotate(-45deg) translate(5px,-5px);
    }

    .container {
      padding-top:140px;
      padding-bottom:40px;
      max-width:1000px;
      margin:0 auto;
      text-align:center;
    }

    .shop-item {
      background:white;
      margin:20px;
      padding:20px;
      border-radius:10px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      display:inline-block;
      vertical-align:top;
      width:calc(33% - 40px);
      box-sizing:border-box;
    }

    .shop-item h3 { font-family:'Playfair Display', serif; }

    /* IMAGE GALLERY STYLING */
    .product-gallery { text-align:center; }
    .main-image {
      width:100%;
      max-width:280px;
      border-radius:10px;
      box-shadow:0 0 5px rgba(0,0,0,0.2);
      transition:0.3s;
    }
    .thumbnail-container {
      margin-top:8px;
      display:flex;
      justify-content:center;
      gap:6px;
      flex-wrap:wrap;
    }
    .thumbnail {
      width:50px;
      height:50px;
      object-fit:cover;
      border-radius:6px;
      cursor:pointer;
      opacity:0.7;
      transition:0.2s;
    }
    .thumbnail:hover { opacity:1; transform:scale(1.05); }

    .shop-item button {
      padding:8px 16px;
      background:#5C4033;
      color:white;
      border:none;
      border-radius:6px;
      cursor:pointer;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    .shop-item button:hover { background:#4e2f22; transform:scale(1.05); }
    .shop-item .price { font-weight:bold; margin-bottom:10px; }

    #cart {
      background:white;
      padding:20px;
      margin:20px auto;
      border-radius:10px;
      max-width:600px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      text-align:left;
    }

    #cart p {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin:8px 0;
      flex-wrap:wrap;
    }

    #cart button.remove-btn {
      background:#c0392b;
      color:white;
      border:none;
      border-radius:4px;
      padding:4px 8px;
      cursor:pointer;
      font-size:0.9em;
    }

    #cart button.remove-btn:hover { background:#e74c3c; }

    #checkout-btn {
      margin-top:10px;
      padding:12px 20px;
      font-size:1.1em;
      background:#5C4033;
      color:white;
      border:none;
      border-radius:8px;
      cursor:pointer;
    }

    #checkout-btn:hover { background:#4e2f22; }

    footer {
      background-color:#5C4033;
      color:white;
      text-align:center;
      padding:20px;
      margin-top:80px;
    }

    #cart-icon {
      position:fixed;
      top:20px;
      right:20px;
      background:#5C4033;
      color:white;
      border-radius:50%;
      width:50px;
      height:50px;
      display:flex;
      justify-content:center;
      align-items:center;
      cursor:pointer;
      z-index:1000;
      font-weight:bold;
    }

    #cart-count {
      position:absolute;
      top:-5px;
      right:-5px;
      background:#c0392b;
      color:white;
      width:18px;
      height:18px;
      border-radius:50%;
      font-size:0.8em;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    #mini-cart {
      position:absolute;
      top:60px;
      right:0;
      width:250px;
      background:white;
      border-radius:10px;
      box-shadow:0 2px 10px rgba(0,0,0,0.2);
      padding:10px;
      display:none;
      z-index:1001;
    }

    #mini-cart p { font-size:0.9em; margin:6px 0; display:flex; justify-content:space-between; }
    #mini-cart button {
      background:#c0392b;
      border:none;
      color:white;
      border-radius:4px;
      font-size:0.8em;
      cursor:pointer;
      padding:2px 6px;
    }

    .cart-animate { transform: scale(1.2); transition: transform 0.3s ease; }
    .show { display:block !important; }

    @media (max-width:1024px){
      .shop-item { width:calc(50% - 40px); }
    }

    @media (max-width:768px){
      #logo { position:static; display:block; margin:10px auto; height:100px; }
      nav { padding-left:0; flex-direction:column; align-items:flex-start; }
      nav ul {
        flex-direction:column;
        width:100%;
        max-height:0;
        overflow:hidden;
        background-color:#5C4033;
      }
      nav li { width:100%; text-align:center; }
      nav a { padding:14px; width:100%; }
      .menu-toggle { display:flex; }
      .menu-toggle.active + ul { max-height:500px; }
      .container { padding:120px 15px 40px; }
      .shop-item { margin:15px auto; width:100%; }
      .thumbnail-container { gap:4px; }
      #cart { width:95%; padding:15px; }
      #cart p { flex-direction:column; align-items:flex-start; }
      #checkout-btn { width:100%; }
      #mini-cart { width:90%; right:5%; }
    }
  </style>
</head>
<body>
  <img id="logo" src="WildTails-PawsWalkers/front logo.png" alt="WildTails Logo" />

  <nav>
    <div class="menu-toggle" id="mobile-menu">
      <div></div>
      <div></div>
      <div></div>
    </div>
    <ul>
      <li><a href="./">Home</a></li>
      <li><a href="about.html">About Us</a></li>
      <li><a href="gallery.html">Gallery</a></li>
      <li><a href="services.html">Services</a></li>
      <li><a href="shop.html">Shop</a></li>
      <li><a href="checkout.html">Check Out</a></li>
      <li><a href="review.html">Reviews</a></li>
      <li><a href="booking.html">Book Now</a></li>
      <li><a href="contact-us.html">Contact Us</a></li>
    </ul>
  </nav>

  <div id="cart-icon">
    ðŸ›’<div id="cart-count">0</div>
    <div id="mini-cart"></div>
  </div>

  <main class="container">
    <section id="Shop">
      <h1>Shop</h1>
      <div id="product-list">Loading products...</div>
    </section>

    <section id="CartSection">
      <h2>Your Cart</h2>
      <div id="cart">Your cart is empty.</div>
      <div id="paypal-button-container"></div>
    </section>
  </main>

  <footer>
    &copy; 2025 WildTails & Paws Walkers â€¢ All Rights Reserved
  </footer>

  <script src="https://www.paypal.com/sdk/js?client-id=AX4Tiv9qeR9nOAof7COXV3oWHrlEmd8yDjiHPA1WCUeFX2joVvxYsB6SGsa1KLBnMUF4qSjmegmWxPXu&currency=GBP"></script>

  <script>
    // --- MOBILE MENU TOGGLE ---
    const menuToggle = document.getElementById('mobile-menu');
    const navMenu = document.querySelector('nav ul');
    menuToggle.addEventListener('click', () => {
      menuToggle.classList.toggle('active');
      navMenu.classList.toggle('show');
    });

    // --- CART SYSTEM ---
    let cart = [];
    const cartIcon = document.getElementById('cart-icon');
    const cartCount = document.getElementById('cart-count');
    const miniCart = document.getElementById('mini-cart');

    async function getProducts() {
      try {
        const res = await fetch('https://printify-server.onrender.com/products');
        const data = await res.json();
        const container = document.getElementById('product-list');
        container.innerHTML = '';

        data.data.forEach(product => {
          const div = document.createElement('div');
          div.className = 'shop-item';

          const images = product.images || [];
          const mainImage = images[0]?.src || '';
          const thumbnailsHTML = images.map(img => `
            <img src="${img.src}" alt="${product.title}" class="thumbnail" onclick="changeImage(this)">
          `).join('');

          const variantsHTML = product.variants?.map(v => `
            <option value='${JSON.stringify({variant_id:v.id,title:v.title,price:v.price/100})}'>
              ${v.title} - Â£${(v.price/100).toFixed(2)}
            </option>
          `).join('') || '';

          div.innerHTML = `
            <h3>${product.title}</h3>
            <div class="product-gallery">
              <img src="${mainImage}" alt="${product.title}" class="main-image">
              <div class="thumbnail-container">${thumbnailsHTML}</div>
            </div>
            <p class="price">Â£${(product.variants?.[0]?.price/100).toFixed(2)}</p>
            <select style="margin-bottom:10px;">${variantsHTML}</select>
            <button>Add to Cart</button>
          `;

          const select = div.querySelector('select');
          const priceP = div.querySelector('.price');
          const button = div.querySelector('button');

          select.addEventListener('change', () => {
            const selected = JSON.parse(select.value);
            priceP.textContent = 'Â£' + selected.price.toFixed(2);
          });

          button.addEventListener('click', () => {
            const selected = JSON.parse(select.value);
            addToCart(selected.variant_id, selected.title, selected.price);
          });

          container.appendChild(div);
        });
      } catch(e) {
        console.error(e);
        document.getElementById('product-list').textContent = 'Failed to load products.';
      }
    }

    function changeImage(element) {
      const gallery = element.closest('.product-gallery');
      const mainImage = gallery.querySelector('.main-image');
      mainImage.src = element.src;
    }

    function addToCart(variantId, title, price) {
      const item = cart.find(i=>i.variant_id===variantId);
      if(item) item.quantity++;
      else cart.push({variant_id:variantId,title,quantity:1,price});
      renderCart();
      cartIcon.classList.add('cart-animate');
      setTimeout(()=>cartIcon.classList.remove('cart-animate'),400);
    }

    function removeFromCart(variantId){
      cart = cart.filter(i=>i.variant_id!==variantId);
      renderCart();
    }

    function renderCart(){
      const cartDiv = document.getElementById('cart');
      cartDiv.innerHTML='';
      miniCart.innerHTML='';
      if(cart.length===0){
        cartDiv.textContent='Your cart is empty.';
        miniCart.textContent='Cart is empty.';
        cartCount.textContent=0;
        miniCart.classList.remove('show');
        return;
      }

      cart.forEach(item=>{
        const p=document.createElement('p');
        const span=document.createElement('span');
        span.textContent=`${item.title} x ${item.quantity} - Â£${(item.price*item.quantity).toFixed(2)}`;
        p.appendChild(span);

        const removeBtn=document.createElement('button');
        removeBtn.className='remove-btn';
        removeBtn.textContent='Remove';
        removeBtn.addEventListener('click', ()=>removeFromCart(item.variant_id));
        p.appendChild(removeBtn);
        cartDiv.appendChild(p);

        const mp=document.createElement('p');
        const miniSpan=document.createElement('span');
        miniSpan.textContent=`${item.title} x ${item.quantity} - Â£${(item.price*item.quantity).toFixed(2)}`;
        mp.appendChild(miniSpan);

        const miniRemoveBtn=document.createElement('button');
        miniRemoveBtn.className='remove-btn';
        miniRemoveBtn.textContent='Ã—';
        miniRemoveBtn.addEventListener('click', ()=>removeFromCart(item.variant_id));
        mp.appendChild(miniRemoveBtn);
        miniCart.appendChild(mp);
      });

      cartCount.textContent=cart.reduce((a,b)=>a+b.quantity,0);
      miniCart.classList.add('show');
    }

    cartIcon.addEventListener('click',()=>{document.getElementById('CartSection').scrollIntoView({behavior:'smooth'});});
    cartIcon.addEventListener('mouseenter',()=>{miniCart.classList.add('show');});
    cartIcon.addEventListener('mouseleave',()=>{miniCart.classList.remove('show');});

    paypal.Buttons({
      createOrder: async (data, actions)=>{
        const res = await fetch('https://printify-server.onrender.com/api/create-paypal-order',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({line_items:cart})
        });
        const d = await res.json();
        return d.id;
      },
      onApprove: async (data, actions)=>{
        const res = await fetch('https://printify-server.onrender.com/api/create-order',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({orderID:data.orderID, line_items:cart})
        });
        const result = await res.json();
        if(result.success){alert('Payment completed and order sent to Printify!'); cart=[]; renderCart();}
        else alert('Something went wrong. Please try again.');
      },
      onError: err=>{console.error(err); alert('PayPal transaction failed.');}
    }).render('#paypal-button-container');

    getProducts();
  </script>
</body>
</html>

